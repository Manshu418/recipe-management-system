<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title><%= recipe.name %></title>
  <link rel="stylesheet" href="/styles.css">
</head>
<body>

<div class="container">

  <header>
    <h1><%= recipe.name %></h1>
    <a href="/" class="btn btn-secondary">‚Üê Back to All Recipes</a>
  </header>

  <main>
    <div class="recipe-detail">

      <!-- Category -->
      <div class="recipe-info">
        <span class="category-badge">
          <%= recipe.category_name || "Uncategorized" %>
        </span>

        <!-- Stats -->
        <div class="recipe-stats">
          <div class="stat">
            <span class="stat-label">Prep Time</span>
            <span class="stat-value"><%= recipe.prep_time || 0 %> min</span>
          </div>

          <div class="stat">
            <span class="stat-label">Cook Time</span>
            <span class="stat-value"><%= recipe.cook_time || 0 %> min</span>
          </div>

          <div class="stat">
            <span class="stat-label">Total</span>
            <span class="stat-value">
              <%= (recipe.prep_time || 0) + (recipe.cook_time || 0) %> min
            </span>
          </div>

          <div class="stat">
            <span class="stat-label">Servings</span>
            <span class="stat-value"><%= recipe.servings || "N/A" %></span>
          </div>
        </div>
      </div>

      <!-- Ingredients -->
      <section class="ingredients-section">
        <h2> Ingredients</h2>

        <div class="ingredients">

          <% if (!ingredients || ingredients.length === 0) { %>
            <p>No ingredients listed.</p>
          <% } else { %>

            <% ingredients.forEach(ing => { %>
              <p>
                ‚Ä¢ <strong><%= ing.ingredient_name %></strong>

                <% if (ing.quantity) { %>
                  ( <%= ing.quantity %> <%= ing.unit_name || "" %> )
                <% } %>
              </p>
            <% }) %>

          <% } %>

        </div>
      </section>

      <!-- Instructions -->
      <section class="instructions-section">
        <h2>üë®‚Äçüç≥ Instructions</h2>

        <div class="instructions">
          <% if (!instructions || instructions.length === 0) { %>
            <p>No instructions listed.</p>
          <% } else { %>

            <% instructions.forEach(step => { %>
              <p><strong>Step <%= step.step_number %>:</strong> <%= step.step_text %></p>
            <% }) %>

          <% } %>
        </div>
      </section>

      <!-- Footer -->
      <div class="recipe-footer">
        <p class="created-date">
          Added on 
          <%= new Date(recipe.created_at).toLocaleDateString("en-US", {
            year: "numeric",
            month: "long",
            day: "numeric"
          }) %>
        </p>

        <% if (session.userId === recipe.user_id) { %>
          <form action="/delete/<%= recipe.id %>" method="POST"
            onsubmit="return confirm('Are you sure you want to delete this recipe?');">
            <button type="submit" class="btn btn-danger">Delete Recipe</button>
          </form>
        <% } %>
      </div>

    </div>
  </main>

</div>

</body>
</html>
